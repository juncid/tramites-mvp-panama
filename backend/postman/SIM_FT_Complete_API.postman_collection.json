{
  "info": {
    "_postman_id": "sim-ft-complete-api-2025",
    "name": "SIM_FT - API Completa",
    "description": "Colecci√≥n completa de todos los endpoints del m√≥dulo SIM_FT (Sistema Integrado de Migraci√≥n - Funcionalidades Transversales) del Sistema de Tr√°mites Migratorios de Panam√°.\n\n**Incluye:**\n- Tipos de Tr√°mites (Cat√°logo maestro)\n- Estatus (Estados de tr√°mites)\n- Conclusiones (Resultados finales)\n- Prioridades (Niveles de urgencia)\n- Pasos (Definici√≥n de pasos del proceso)\n- Flujo de Pasos (Asociaci√≥n pasos-tr√°mites)\n- Usuarios y Secciones (Asignaciones)\n- Tr√°mites SIM_FT (Gesti√≥n completa con Redis Caching)\n- Pasos de Tr√°mites (Seguimiento detallado)\n- Cierre de Tr√°mites (Finalizaci√≥n)\n- Estad√≠sticas (Reportes y m√©tricas)\n- **üéØ EJEMPLOS CON DATOS DE PRUEBA: PERM_TEMP** (Carpeta 12)\n\n**üöÄ NUEVO - Redis Caching:**\n- GET /tramites: Cache con TTL 5 minutos\n- GET /tramites/{id}: Cache individual por tr√°mite\n- POST/PUT: Invalidaci√≥n autom√°tica de cache\n\n**üß™ DATOS DE PRUEBA INCLUIDOS:**\n- Tipo: PERM_TEMP (Permiso Temporal)\n- Tr√°mites: 5001 (paso 2), 5002 (paso 4), 5003 (finalizado)\n- 6 pasos configurados (Recepci√≥n ‚Üí Emisi√≥n)\n- Flujo completo end-to-end\n- Ver: backend/sql/README_SIM_FT_TEST_DATA.md\n\n**‚ö†Ô∏è DEPRECADOS:**\nLos endpoints legacy /tramites est√°n deprecados.\nUsar exclusivamente /sim-ft/tramites\n\n**Autor:** Sistema de Tr√°mites MVP Panam√°\n**Fecha:** 2025-10-24\n**Versi√≥n:** 2.1.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "api_prefix",
      "value": "/api/v1/sim-ft",
      "type": "string"
    },
    {
      "key": "cod_tramite",
      "value": "PERM_TEMP",
      "type": "string",
      "description": "C√≥digo del tr√°mite de prueba (PERM_TEMP = Permiso Temporal)"
    },
    {
      "key": "num_annio",
      "value": "2025",
      "type": "string"
    },
    {
      "key": "num_tramite",
      "value": "5001",
      "type": "string",
      "description": "N√∫mero de tr√°mite de prueba (5001, 5002, 5003)"
    },
    {
      "key": "num_registro",
      "value": "1",
      "type": "string",
      "description": "N√∫mero de registro (siempre 1 para datos de prueba)"
    },
    {
      "key": "num_paso",
      "value": "3",
      "type": "string",
      "description": "N√∫mero de paso (1-6 para PERM_TEMP)"
    }
  ],
  "item": [
    {
      "name": "1. Tipos de Tr√°mites",
      "item": [
        {
          "name": "Listar Tipos de Tr√°mites",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.json().length > 0) {",
                  "    pm.collectionVariables.set(\"cod_tramite\", pm.response.json()[0].cod_tramite);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites-tipos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites-tipos"]
            },
            "description": "Obtiene todos los tipos de tr√°mites disponibles en el sistema SIM_FT"
          },
          "response": []
        },
        {
          "name": "Obtener Tipo de Tr√°mite por C√≥digo",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Has required fields\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('cod_tramite');",
                  "    pm.expect(jsonData).to.have.property('nombre_tramite');",
                  "});"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites-tipos/{{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites-tipos", "{{cod_tramite}}"]
            },
            "description": "Obtiene un tipo de tr√°mite espec√≠fico por su c√≥digo"
          },
          "response": []
        },
        {
          "name": "Crear Tipo de Tr√°mite",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.collectionVariables.set(\"cod_tramite\", pm.response.json().cod_tramite);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_TRAMITE\": \"VISA_TUR\",\n  \"DESC_TRAMITE\": \"Visa de Turista - Solicitud y renovaci√≥n para extranjeros\",\n  \"PAG_TRAMITE\": \"https://migracion.gob.pa/visa-turista\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites-tipos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites-tipos"]
            },
            "description": "Crea un nuevo tipo de tr√°mite en el cat√°logo"
          },
          "response": []
        },
        {
          "name": "Actualizar Tipo de Tr√°mite",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"DESC_TRAMITE\": \"Visa de Turista - Solicitud actualizada\",\n  \"PAG_TRAMITE\": \"https://migracion.gob.pa/visa-turista-nuevo\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites-tipos/{{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites-tipos", "{{cod_tramite}}"]
            },
            "description": "Actualiza un tipo de tr√°mite existente"
          },
          "response": []
        },
        {
          "name": "Eliminar Tipo de Tr√°mite",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites-tipos/{{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites-tipos", "{{cod_tramite}}"]
            },
            "description": "Elimina un tipo de tr√°mite (soft delete)"
          },
          "response": []
        }
      ]
    },
    {
      "name": "2. Estatus",
      "item": [
        {
          "name": "Listar Estatus",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estatus",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estatus"]
            },
            "description": "Obtiene todos los estados disponibles para tr√°mites"
          },
          "response": []
        },
        {
          "name": "Obtener Estatus por C√≥digo",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estatus/01",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estatus", "01"]
            },
            "description": "Obtiene un estatus espec√≠fico por su c√≥digo"
          },
          "response": []
        },
        {
          "name": "Crear Estatus",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_ESTATUS\": \"11\",\n  \"NOM_ESTATUS\": \"Entregado\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estatus",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estatus"]
            },
            "description": "Crea un nuevo estatus"
          },
          "response": []
        },
        {
          "name": "Actualizar Estatus",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NOM_ESTATUS\": \"En Proceso de Revisi√≥n\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estatus/11",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estatus", "11"]
            },
            "description": "Actualiza un estatus existente"
          },
          "response": []
        }
      ]
    },
    {
      "name": "3. Conclusiones",
      "item": [
        {
          "name": "Listar Conclusiones",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/conclusiones",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["conclusiones"]
            },
            "description": "Obtiene todas las conclusiones posibles para tr√°mites"
          },
          "response": []
        },
        {
          "name": "Crear Conclusi√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_CONCLUSION\": \"SU\",\n  \"NOM_CONCLUSION\": \"Suspendido\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/conclusiones",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["conclusiones"]
            },
            "description": "Crea una nueva conclusi√≥n"
          },
          "response": []
        }
      ]
    },
    {
      "name": "4. Prioridades",
      "item": [
        {
          "name": "Listar Prioridades",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/prioridades",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["prioridades"]
            },
            "description": "Obtiene todas las prioridades disponibles"
          },
          "response": []
        },
        {
          "name": "Crear Prioridad",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_PRIORIDAD\": \"5\",\n  \"NOM_PRIORIDAD\": \"Muy Baja\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/prioridades",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["prioridades"]
            },
            "description": "Crea una nueva prioridad"
          },
          "response": []
        }
      ]
    },
    {
      "name": "5. Pasos",
      "item": [
        {
          "name": "Listar Pasos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pasos?cod_tramite={{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["pasos"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "{{cod_tramite}}"
                }
              ]
            },
            "description": "Obtiene todos los pasos, opcionalmente filtrados por tipo de tr√°mite"
          },
          "response": []
        },
        {
          "name": "Obtener Paso Espec√≠fico",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pasos/{{cod_tramite}}/1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["pasos", "{{cod_tramite}}", "1"]
            },
            "description": "Obtiene un paso espec√≠fico por c√≥digo de tr√°mite y n√∫mero de paso"
          },
          "response": []
        },
        {
          "name": "Crear Paso",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_TRAMITE\": \"{{cod_tramite}}\",\n  \"NUM_PASO\": 6,\n  \"NOM_DESCRIPCION\": \"Entrega de Documentos\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pasos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["pasos"]
            },
            "description": "Crea un nuevo paso"
          },
          "response": []
        },
        {
          "name": "Actualizar Paso",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NOM_DESCRIPCION\": \"Recepci√≥n y Verificaci√≥n de Documentos\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pasos/{{cod_tramite}}/1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["pasos", "{{cod_tramite}}", "1"]
            },
            "description": "Actualiza un paso existente"
          },
          "response": []
        }
      ]
    },
    {
      "name": "6. Flujo de Pasos",
      "item": [
        {
          "name": "Listar Flujo de Pasos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/flujo-pasos?cod_tramite={{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["flujo-pasos"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "{{cod_tramite}}"
                }
              ]
            },
            "description": "Obtiene el flujo de pasos asociados a tr√°mites"
          },
          "response": []
        },
        {
          "name": "Crear Asociaci√≥n Flujo-Paso",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"COD_TRAMITE\": \"{{cod_tramite}}\",\n  \"NUM_PASO\": 6,\n  \"COD_SECCION\": \"0101\",\n  \"ID_PASO_SGTE\": null,\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/flujo-pasos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["flujo-pasos"]
            },
            "description": "Asocia un paso a un tipo de tr√°mite en el flujo"
          },
          "response": []
        }
      ]
    },
    {
      "name": "7. Usuarios y Secciones",
      "item": [
        {
          "name": "Listar Usuarios-Secciones",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/usuarios-secciones?cod_seccion=MIGRACION",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["usuarios-secciones"],
              "query": [
                {
                  "key": "cod_seccion",
                  "value": "MIGRACION"
                }
              ]
            },
            "description": "Obtiene asignaciones de usuarios a secciones"
          },
          "response": []
        },
        {
          "name": "Crear Asignaci√≥n Usuario-Secci√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"ID_USUARIO\": \"USR008\",\n  \"COD_SECCION\": \"0101\",\n  \"COD_AGENCIA\": \"01\",\n  \"IND_ACTIVO\": \"S\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/usuarios-secciones",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["usuarios-secciones"]
            },
            "description": "Asigna un usuario a una secci√≥n"
          },
          "response": []
        }
      ]
    },
    {
      "name": "8. Tr√°mites SIM_FT",
      "item": [
        {
          "name": "Listar Tr√°mites (con Cache)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response is array\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.be.an('array');",
                  "});",
                  "",
                  "pm.test(\"Response time is acceptable\", function () {",
                  "    // Primera llamada: DB query (~100-500ms)",
                  "    // Segunda llamada: Cache (~5-50ms)",
                  "    pm.expect(pm.response.responseTime).to.be.below(1000);",
                  "});",
                  "",
                  "if (pm.response.json().length > 0) {",
                  "    var tramite = pm.response.json()[0];",
                  "    pm.collectionVariables.set(\"num_annio\", tramite.NUM_ANNIO);",
                  "    pm.collectionVariables.set(\"num_tramite\", tramite.NUM_TRAMITE);",
                  "    pm.collectionVariables.set(\"num_registro\", tramite.NUM_REGISTRO);",
                  "    ",
                  "    pm.test(\"Tramite has required fields\", function () {",
                  "        pm.expect(tramite).to.have.property('NUM_ANNIO');",
                  "        pm.expect(tramite).to.have.property('NUM_TRAMITE');",
                  "        pm.expect(tramite).to.have.property('COD_TRAMITE');",
                  "        pm.expect(tramite).to.have.property('IND_ESTATUS');",
                  "    });",
                  "}",
                  "",
                  "console.log(\"‚úÖ Datos cacheados en Redis con TTL 5 minutos\");",
                  "console.log(\"üîë Cache Key: sim_ft:tramites:{num_annio}:{cod}:{status}:...\");"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites?num_annio={{num_annio}}&skip=0&limit=10",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites"],
              "query": [
                {
                  "key": "num_annio",
                  "value": "{{num_annio}}",
                  "description": "A√±o del tr√°mite (parte de la PK)"
                },
                {
                  "key": "cod_tramite",
                  "value": "{{cod_tramite}}",
                  "description": "C√≥digo del tipo de tr√°mite",
                  "disabled": true
                },
                {
                  "key": "ind_estatus",
                  "value": "A",
                  "description": "Estatus del tr√°mite (A=Activo, C=Cerrado, etc.)",
                  "disabled": true
                },
                {
                  "key": "ind_prioridad",
                  "value": "1",
                  "description": "Prioridad (1=Alta, 2=Media, 3=Baja)",
                  "disabled": true
                },
                {
                  "key": "fecha_desde",
                  "value": "2025-01-01",
                  "description": "Fecha inicio (YYYY-MM-DD)",
                  "disabled": true
                },
                {
                  "key": "fecha_hasta",
                  "value": "2025-12-31",
                  "description": "Fecha fin (YYYY-MM-DD)",
                  "disabled": true
                },
                {
                  "key": "skip",
                  "value": "0",
                  "description": "Offset para paginaci√≥n"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "L√≠mite de resultados (max 100)"
                }
              ]
            },
            "description": "**Obtiene tr√°mites con filtros opcionales y caching**\n\n‚úÖ **Redis Cache:** Activado\n- **TTL:** 300 segundos (5 minutos)\n- **Cache Key:** `sim_ft:tramites:{num_annio}:{cod_tramite}:{ind_estatus}:{ind_prioridad}:{skip}:{limit}:{fecha_desde}:{fecha_hasta}`\n\nüìå **Filtros Disponibles:**\n- `num_annio`: A√±o del tr√°mite\n- `cod_tramite`: C√≥digo del tipo de tr√°mite\n- `ind_estatus`: Estado del tr√°mite\n- `ind_prioridad`: Nivel de prioridad\n- `fecha_desde/hasta`: Rango de fechas\n- `skip/limit`: Paginaci√≥n\n\nüîÑ **Invalidaci√≥n:** Cache se borra al crear/actualizar tr√°mites"
          },
          "response": []
        },
        {
          "name": "Obtener Tr√°mite por ID (con Cache)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has tramite data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('NUM_ANNIO');",
                  "    pm.expect(jsonData).to.have.property('NUM_TRAMITE');",
                  "    pm.expect(jsonData).to.have.property('NUM_REGISTRO');",
                  "    pm.expect(jsonData).to.have.property('COD_TRAMITE');",
                  "});",
                  "",
                  "pm.test(\"Response time with cache\", function () {",
                  "    // Con cache debe ser muy r√°pido",
                  "    pm.expect(pm.response.responseTime).to.be.below(500);",
                  "});",
                  "",
                  "console.log(\"‚úÖ Tr√°mite individual cacheado\");",
                  "console.log(\"üîë Cache Key: sim_ft:tramite:\" + pm.collectionVariables.get(\"num_annio\") + \":\" + pm.collectionVariables.get(\"num_tramite\") + \":\" + pm.collectionVariables.get(\"num_registro\"));"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_registro}}"]
            },
            "description": "**Obtiene un tr√°mite espec√≠fico con caching individual**\n\n‚úÖ **Redis Cache:** Activado\n- **TTL:** 300 segundos (5 minutos)\n- **Cache Key:** `sim_ft:tramite:{num_annio}:{num_tramite}:{num_registro}`\n\nüìå **Par√°metros (Composite Key):**\n- `num_annio`: A√±o del tr√°mite (ej: 2025)\n- `num_tramite`: N√∫mero secuencial del tr√°mite\n- `num_registro`: N√∫mero de registro\n\nüîÑ **Invalidaci√≥n:** Cache se borra al actualizar este tr√°mite o crear/actualizar cualquier tr√°mite"
          },
          "response": []
        },
        {
          "name": "Crear Tr√°mite (Invalida Cache)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "    pm.response.to.have.status(201);",
                  "});",
                  "",
                  "pm.test(\"Response has tramite data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('NUM_ANNIO');",
                  "    pm.expect(jsonData).to.have.property('NUM_TRAMITE');",
                  "    pm.expect(jsonData).to.have.property('NUM_REGISTRO');",
                  "});",
                  "",
                  "if (pm.response.code === 201) {",
                  "    var tramite = pm.response.json();",
                  "    pm.collectionVariables.set(\"num_annio\", tramite.NUM_ANNIO);",
                  "    pm.collectionVariables.set(\"num_tramite\", tramite.NUM_TRAMITE);",
                  "    pm.collectionVariables.set(\"num_registro\", tramite.NUM_REGISTRO);",
                  "    ",
                  "    console.log(\"‚úÖ Tr√°mite creado: \" + tramite.NUM_ANNIO + \"-\" + tramite.NUM_TRAMITE + \"-\" + tramite.NUM_REGISTRO);",
                  "    console.log(\"üóëÔ∏è Cache invalidado: redis.keys('sim_ft:tramites:*') eliminados\");",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NUM_ANNIO\": 2025,\n  \"NUM_TRAMITE\": 100,\n  \"NUM_REGISTRO\": 100,\n  \"COD_TRAMITE\": \"{{cod_tramite}}\",\n  \"IND_ESTATUS\": \"01\",\n  \"IND_PRIORIDAD\": \"3\",\n  \"OBS_OBSERVA\": \"Tr√°mite de prueba - Cache Invalidation Test\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites"]
            },
            "description": "**Crea un nuevo tr√°mite e invalida el cache**\n\nüóëÔ∏è **Cache Invalidation:** Autom√°tico\n- Elimina todas las claves `sim_ft:tramites:*`\n- Elimina todas las claves `sim_ft:tramite:*`\n- Pattern: `redis.keys()` + `redis.delete(*keys)`\n\nüìå **Campos Requeridos:**\n- `NUM_ANNIO`: A√±o del tr√°mite (parte de PK)\n- `NUM_TRAMITE`: N√∫mero del tr√°mite (parte de PK)\n- `NUM_REGISTRO`: Registro (parte de PK)\n- `COD_TRAMITE`: C√≥digo del tipo de tr√°mite (FK)\n- `IND_ESTATUS`: C√≥digo de estatus (FK)\n\nüìå **Campos Opcionales:**\n- `IND_PRIORIDAD`: Prioridad (1-5)\n- `OBS_OBSERVA`: Observaciones\n- `FEC_INI_TRAMITE`: Fecha inicio\n- `ID_USUARIO_CREA`: Usuario creador\n\n‚ö° **Nota:** Despu√©s de crear, las pr√≥ximas consultas GET reconstruir√°n el cache"
          },
          "response": []
        },
        {
          "name": "Actualizar Tr√°mite (Invalida Cache)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", function () {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Response has updated data\", function () {",
                  "    var jsonData = pm.response.json();",
                  "    pm.expect(jsonData).to.have.property('FEC_ACTUALIZA');",
                  "});",
                  "",
                  "console.log(\"‚úÖ Tr√°mite actualizado\");",
                  "console.log(\"üóëÔ∏è Cache invalidado: Todas las claves sim_ft:tramites:* eliminadas\");"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"IND_ESTATUS\": \"02\",\n  \"IND_PRIORIDAD\": \"2\",\n  \"OBS_OBSERVA\": \"Actualizado - en proceso de revisi√≥n (Cache Invalidation Test)\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_registro}}"]
            },
            "description": "**Actualiza un tr√°mite existente e invalida el cache**\n\nüóëÔ∏è **Cache Invalidation:** Autom√°tico\n- Elimina todas las claves de cache de tr√°mites\n- Asegura consistencia de datos despu√©s de update\n\nüìå **Campos Actualizables:**\n- `IND_ESTATUS`: Cambiar estado del tr√°mite\n- `IND_PRIORIDAD`: Ajustar prioridad\n- `OBS_OBSERVA`: Actualizar observaciones\n- `FEC_FIN_TRAMITE`: Establecer fecha de finalizaci√≥n\n- `IND_CONCLUSION`: Marcar tipo de conclusi√≥n\n\n‚ö° **Nota:** \n- Solo incluir campos a actualizar (partial update con Pydantic v2)\n- `FEC_ACTUALIZA` se actualiza autom√°ticamente\n- Cache se reconstruir√° en pr√≥xima consulta GET"
          },
          "response": []
        }
      ]
    },
    {
      "name": "9. Pasos de Tr√°mites",
      "item": [
        {
          "name": "Listar Pasos del Tr√°mite",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.json().length > 0) {",
                  "    pm.collectionVariables.set(\"num_paso\", pm.response.json()[0].num_paso);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/pasos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "pasos"]
            },
            "description": "Obtiene todos los pasos ejecutados de un tr√°mite"
          },
          "response": []
        },
        {
          "name": "Obtener Paso del Tr√°mite",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_paso}}/{{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_paso}}", "{{num_registro}}"]
            },
            "description": "Obtiene un paso espec√≠fico de un tr√°mite"
          },
          "response": []
        },
        {
          "name": "Registrar Paso del Tr√°mite",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NUM_ANNIO\": 2025,\n  \"NUM_TRAMITE\": 100,\n  \"NUM_PASO\": 1,\n  \"NUM_REGISTRO\": 100,\n  \"COD_TRAMITE\": \"{{cod_tramite}}\",\n  \"COD_SECCION\": \"0101\",\n  \"COD_AGENCIA\": \"01\",\n  \"ID_USUAR_RESP\": \"USR001\",\n  \"OBS_OBSERVACION\": \"Documentos recibidos y verificados\",\n  \"IND_ESTATUS\": \"10\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/pasos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "pasos"]
            },
            "description": "Registra la ejecuci√≥n de un paso en el tr√°mite"
          },
          "response": []
        },
        {
          "name": "Actualizar Paso del Tr√°mite",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"OBS_OBSERVACION\": \"Actualizado - documentaci√≥n completa verificada\",\n  \"IND_ESTATUS\": \"10\",\n  \"IND_CONCLUSION\": \"AP\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_paso}}/{{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_paso}}", "{{num_registro}}"]
            },
            "description": "Actualiza un paso registrado del tr√°mite"
          },
          "response": []
        }
      ]
    },
    {
      "name": "10. Cierre de Tr√°mites",
      "item": [
        {
          "name": "Cerrar Tr√°mite",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NUM_ANNIO\": 2025,\n  \"NUM_TRAMITE\": 100,\n  \"NUM_REGISTRO\": 100,\n  \"FEC_CIERRE\": \"2025-10-23T12:00:00\",\n  \"ID_USUARIO_CIERRE\": \"USR003\",\n  \"OBS_CIERRE\": \"Tr√°mite completado satisfactoriamente. Todos los requisitos cumplidos.\",\n  \"COD_CONCLUSION\": \"AP\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_registro}}/cierre",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_registro}}", "cierre"]
            },
            "description": "Cierra un tr√°mite con una conclusi√≥n final"
          },
          "response": []
        },
        {
          "name": "Obtener Informaci√≥n de Cierre",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_registro}}/cierre",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_registro}}", "cierre"]
            },
            "description": "Obtiene la informaci√≥n de cierre de un tr√°mite"
          },
          "response": []
        }
      ]
    },
    {
      "name": "11. Estad√≠sticas",
      "item": [
        {
          "name": "Tr√°mites por Estado",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estadisticas/tramites-por-estado?fecha_inicio=2025-01-01&fecha_fin=2025-12-31",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estadisticas", "tramites-por-estado"],
              "query": [
                {
                  "key": "fecha_inicio",
                  "value": "2025-01-01"
                },
                {
                  "key": "fecha_fin",
                  "value": "2025-12-31"
                }
              ]
            },
            "description": "Obtiene estad√≠sticas de tr√°mites agrupados por estado"
          },
          "response": []
        },
        {
          "name": "Tr√°mites por Tipo",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estadisticas/tramites-por-tipo?fecha_inicio=2025-01-01&fecha_fin=2025-12-31",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estadisticas", "tramites-por-tipo"],
              "query": [
                {
                  "key": "fecha_inicio",
                  "value": "2025-01-01"
                },
                {
                  "key": "fecha_fin",
                  "value": "2025-12-31"
                }
              ]
            },
            "description": "Obtiene estad√≠sticas de tr√°mites agrupados por tipo"
          },
          "response": []
        },
        {
          "name": "Tiempo Promedio de Tr√°mites",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estadisticas/tiempo-promedio?cod_tramite={{cod_tramite}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estadisticas", "tiempo-promedio"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "{{cod_tramite}}"
                }
              ]
            },
            "description": "Obtiene el tiempo promedio de procesamiento por tipo de tr√°mite"
          },
          "response": []
        }
      ]
    },
    {
      "name": "12. üéØ EJEMPLOS: Flujo PERM_TEMP (Datos de Prueba)",
      "description": "Carpeta con ejemplos completos usando los datos de prueba PERM_TEMP.\n\n**Prerequisito**: Cargar datos con `backend/sql/seed_sim_ft_test_data.sql`\n\n**Datos disponibles:**\n- Tipo: PERM_TEMP (Permiso Temporal)\n- Tr√°mite 5001: En paso 2 (Verificaci√≥n)\n- Tr√°mite 5002: En paso 4 (Aprobaci√≥n)\n- Tr√°mite 5003: Finalizado (Aprobado)\n\n**Flujo sugerido:**\n1. Consultar cat√°logos (pasos, flujo)\n2. Ver listado de tr√°mites PERM_TEMP\n3. Consultar detalle de tr√°mite 5001\n4. Ver historial de pasos\n5. Avanzar tr√°mite al paso 3\n6. Consultar estad√≠sticas",
      "item": [
        {
          "name": "1. Ver Pasos de PERM_TEMP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene 6 pasos\", () => {",
                  "    const pasos = pm.response.json();",
                  "    pm.expect(pasos).to.have.lengthOf(6);",
                  "});",
                  "pm.test(\"Paso 1 es Recepci√≥n\", () => {",
                  "    const paso1 = pm.response.json()[0];",
                  "    pm.expect(paso1.NOM_DESCRIPCION).to.include('Recepci√≥n');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/pasos?cod_tramite=PERM_TEMP",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["pasos"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "PERM_TEMP",
                  "description": "Permiso Temporal - 6 pasos"
                }
              ]
            },
            "description": "Consulta los 6 pasos configurados para el tr√°mite PERM_TEMP:\n1. Recepci√≥n de Solicitud\n2. Verificaci√≥n de Documentos\n3. Evaluaci√≥n Legal\n4. Aprobaci√≥n Directiva\n5. Verificaci√≥n de Pago\n6. Emisi√≥n de Permiso"
          },
          "response": []
        },
        {
          "name": "2. Ver Flujo de PERM_TEMP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene 6 configuraciones de flujo\", () => {",
                  "    pm.expect(pm.response.json()).to.have.lengthOf(6);",
                  "});",
                  "pm.test(\"Paso 1 va a paso 2\", () => {",
                  "    const flujo1 = pm.response.json().find(f => f.NUM_PASO === 1);",
                  "    pm.expect(flujo1.ID_PASO_SGTE).to.equal(2);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/flujo-pasos?cod_tramite=PERM_TEMP",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["flujo-pasos"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "PERM_TEMP"
                }
              ]
            },
            "description": "Consulta el flujo secuencial configurado:\n- Paso 1 ‚Üí 2 ‚Üí 3 ‚Üí 4 ‚Üí 5 ‚Üí 6 ‚Üí FIN\n- Cada paso tiene asignada una secci√≥n (0101-0106)"
          },
          "response": []
        },
        {
          "name": "3. Listar Tr√°mites PERM_TEMP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene al menos 3 tr√°mites\", () => {",
                  "    pm.expect(pm.response.json().length).to.be.at.least(3);",
                  "});",
                  "pm.test(\"Tr√°mite 5001 existe\", () => {",
                  "    const tramites = pm.response.json();",
                  "    const t5001 = tramites.find(t => t.NUM_TRAMITE === 5001);",
                  "    pm.expect(t5001).to.not.be.undefined;",
                  "    pm.expect(t5001.COD_TRAMITE).to.equal('PERM_TEMP');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites?cod_tramite=PERM_TEMP",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "PERM_TEMP"
                }
              ]
            },
            "description": "Lista los 3 tr√°mites de prueba:\n- 5001: En Revisi√≥n (paso 2)\n- 5002: En Evaluaci√≥n (paso 4)\n- 5003: Finalizado (Aprobado)"
          },
          "response": []
        },
        {
          "name": "4. Detalle Tr√°mite 5001 (En Revisi√≥n)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Es tr√°mite 5001\", () => {",
                  "    const t = pm.response.json();",
                  "    pm.expect(t.NUM_TRAMITE).to.equal(5001);",
                  "    pm.expect(t.COD_TRAMITE).to.equal('PERM_TEMP');",
                  "});",
                  "pm.test(\"Est√° en estado 02 (En Revisi√≥n)\", () => {",
                  "    pm.expect(pm.response.json().IND_ESTATUS).to.equal('02');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/{{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "{{num_registro}}"]
            },
            "description": "Consulta detalle completo del tr√°mite 5001:\n- Solicitante: Juan Rodr√≠guez\n- Pasaporte: P123456\n- Estado: 02 (En Revisi√≥n)\n- Prioridad: 2 (Alta)\n- Actualmente en paso 2 de 6"
          },
          "response": []
        },
        {
          "name": "5. Historial de Pasos Tr√°mite 5001",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene 2 pasos registrados\", () => {",
                  "    pm.expect(pm.response.json()).to.have.lengthOf(2);",
                  "});",
                  "pm.test(\"√öltimo paso es el 2\", () => {",
                  "    const pasos = pm.response.json();",
                  "    const ultimoPaso = pasos[pasos.length - 1];",
                  "    pm.expect(ultimoPaso.NUM_PASO).to.equal(2);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/pasos?num_registro={{num_registro}}",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "pasos"],
              "query": [
                {
                  "key": "num_registro",
                  "value": "{{num_registro}}"
                }
              ]
            },
            "description": "Consulta el historial de pasos ejecutados del tr√°mite 5001:\n- Paso 1: Recepci√≥n (hace 5 d√≠as)\n- Paso 2: Verificaci√≥n (hace 3 d√≠as) - ACTUAL"
          },
          "response": []
        },
        {
          "name": "6. Avanzar Tr√°mite 5001 a Paso 3",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 201 Created\", () => pm.response.to.have.status(201));",
                  "pm.test(\"Paso 3 creado\", () => {",
                  "    const detalle = pm.response.json();",
                  "    pm.expect(detalle.NUM_PASO).to.equal(3);",
                  "    pm.expect(detalle.IND_ESTATUS).to.equal('02');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"NUM_PASO\": 3,\n  \"IND_ESTATUS\": \"02\",\n  \"OBS_OBSERVA\": \"Evaluaci√≥n legal iniciada - Revisando documentaci√≥n jur√≠dica\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/{{num_annio}}/{{num_tramite}}/pasos",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "{{num_annio}}", "{{num_tramite}}", "pasos"]
            },
            "description": "Avanza el tr√°mite 5001 del paso 2 al paso 3 (Evaluaci√≥n Legal).\n\n**IMPORTANTE**: Este es un endpoint POST que crea un nuevo registro en el historial.\n\nDespu√©s de ejecutar:\n1. Volver a consultar historial (request #5)\n2. Verificar que ahora tiene 3 pasos\n3. El √∫ltimo paso debe ser el paso 3"
          },
          "response": []
        },
        {
          "name": "7. Detalle Tr√°mite 5002 (En Evaluaci√≥n)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Es tr√°mite 5002\", () => {",
                  "    pm.expect(pm.response.json().NUM_TRAMITE).to.equal(5002);",
                  "});",
                  "pm.test(\"Est√° en estado 04 (En Evaluaci√≥n)\", () => {",
                  "    pm.expect(pm.response.json().IND_ESTATUS).to.equal('04');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/2025/5002/1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "2025", "5002", "1"]
            },
            "description": "Consulta tr√°mite 5002:\n- Solicitante: Mar√≠a Gonz√°lez\n- Pasaporte: V987654\n- Estado: 04 (En Evaluaci√≥n)\n- Prioridad: 1 (Urgente)\n- En paso 4 de 6 (Aprobaci√≥n Directiva)"
          },
          "response": []
        },
        {
          "name": "8. Historial Tr√°mite 5002 (4 pasos)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene 4 pasos\", () => {",
                  "    pm.expect(pm.response.json()).to.have.lengthOf(4);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/2025/5002/pasos?num_registro=1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "2025", "5002", "pasos"],
              "query": [
                {
                  "key": "num_registro",
                  "value": "1"
                }
              ]
            },
            "description": "Historial completo hasta el paso 4:\n1. Recepci√≥n OK\n2. Documentos verificados\n3. Evaluaci√≥n legal completada\n4. Esperando aprobaci√≥n directiva (ACTUAL)"
          },
          "response": []
        },
        {
          "name": "9. Cerrar Tr√°mite 5002 (Aprobado)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene conclusi√≥n AP (Aprobado)\", () => {",
                  "    const cierre = pm.response.json();",
                  "    pm.expect(cierre.IND_CONCLUSION).to.equal('AP');",
                  "});",
                  "pm.test(\"Tiene fecha de finalizaci√≥n\", () => {",
                  "    pm.expect(pm.response.json().FEC_FIN_TRAMITE).to.not.be.null;",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"IND_CONCLUSION\": \"AP\",\n  \"OBS_CONCLUSION\": \"Permiso temporal aprobado. Documentaci√≥n completa y cumple requisitos.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/2025/5002/1/cierre",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "2025", "5002", "1", "cierre"]
            },
            "description": "Finaliza el tr√°mite 5002 con conclusi√≥n APROBADO.\n\n**IMPORTANTE**: Este endpoint:\n- Actualiza IND_CONCLUSION a 'AP'\n- Establece FEC_FIN_TRAMITE con la fecha actual\n- Cambia IND_ESTATUS a '10' (Finalizado)\n\nDespu√©s de ejecutar, consultar nuevamente el tr√°mite 5002 para ver los cambios."
          },
          "response": []
        },
        {
          "name": "10. Detalle Tr√°mite 5003 (Finalizado)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Est√° finalizado\", () => {",
                  "    const t = pm.response.json();",
                  "    pm.expect(t.IND_ESTATUS).to.equal('10');",
                  "    pm.expect(t.IND_CONCLUSION).to.equal('AP');",
                  "    pm.expect(t.FEC_FIN_TRAMITE).to.not.be.null;",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/2025/5003/1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "2025", "5003", "1"]
            },
            "description": "Ejemplo de tr√°mite completado:\n- Solicitante: Pedro Mart√≠nez\n- Pasaporte: N456789\n- Estado: 10 (Finalizado)\n- Conclusi√≥n: AP (Aprobado)\n- Complet√≥ los 6 pasos en 19 d√≠as"
          },
          "response": []
        },
        {
          "name": "11. Historial Completo Tr√°mite 5003 (6 pasos)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene los 6 pasos completos\", () => {",
                  "    pm.expect(pm.response.json()).to.have.lengthOf(6);",
                  "});",
                  "pm.test(\"√öltimo paso es Emisi√≥n\", () => {",
                  "    const pasos = pm.response.json();",
                  "    const paso6 = pasos.find(p => p.NUM_PASO === 6);",
                  "    pm.expect(paso6).to.not.be.undefined;",
                  "    pm.expect(paso6.OBS_OBSERVA).to.include('emitido');",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/tramites/2025/5003/pasos?num_registro=1",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["tramites", "2025", "5003", "pasos"],
              "query": [
                {
                  "key": "num_registro",
                  "value": "1"
                }
              ]
            },
            "description": "Historial completo del flujo:\n1. Recepci√≥n (hace 20 d√≠as)\n2. Verificaci√≥n OK (hace 18 d√≠as)\n3. Evaluaci√≥n legal OK (hace 15 d√≠as)\n4. Aprobado por director (hace 10 d√≠as)\n5. Pago verificado (hace 5 d√≠as)\n6. Permiso emitido (hace 1 d√≠a)\n\n**Ideal para entender el flujo completo end-to-end**"
          },
          "response": []
        },
        {
          "name": "12. Estad√≠sticas de PERM_TEMP",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status 200\", () => pm.response.to.have.status(200));",
                  "pm.test(\"Tiene estad√≠sticas\", () => {",
                  "    const stats = pm.response.json();",
                  "    pm.expect(stats.total_tramites).to.be.at.least(3);",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}{{api_prefix}}/estadisticas?cod_tramite=PERM_TEMP",
              "host": ["{{base_url}}{{api_prefix}}"],
              "path": ["estadisticas"],
              "query": [
                {
                  "key": "cod_tramite",
                  "value": "PERM_TEMP"
                }
              ]
            },
            "description": "Estad√≠sticas espec√≠ficas de tr√°mites PERM_TEMP:\n- Total de tr√°mites\n- Distribuci√≥n por estado\n- Distribuci√≥n por prioridad\n- Tr√°mites finalizados vs en proceso"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Health Check SIM_FT",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{base_url}}/health",
          "host": ["{{base_url}}"],
          "path": ["health"]
        },
        "description": "Verifica el estado de salud del m√≥dulo SIM_FT"
      },
      "response": []
    }
  ]
}
